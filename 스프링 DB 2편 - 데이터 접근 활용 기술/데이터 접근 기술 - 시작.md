## 데이터 접근 기술

**적용 데이터 접근 기술**

- JdbcTemplate
- MyBatis
- JPA, Hibernate
- 스프링 데이터 JPA
- Querydsl

**SQLMapper**

- JdbcTemplate
- MyBatis
- **주요기능**
    - 개발자는 SQL만 작성하면 해당 SQL 결과를 객체로 편하게 매핑 해준다.
    - JDBC를 집적 사용할 때 발생하는 여러가지 중복을 제가하고, 기타 개발자에게 여러가지 편리한 기능 제공

**ORM 관련 기술**

- JPA, Hibernate
- 스프링 데이터 JPA
- Queryds
- **주요기능**
    - SQL은 JPA가 대신 장성하고 처리해준다.
    - JAP는 자바 진영의 ORM 표준이고, Hibernate(하이버네이트)는 JPA에서 가장 많이 사용하는 구현체이다.자바에서 ORM을 사용할 때는 JPA 인터페이스를 사용하고, 그 구현체로 하이버네이트를 사용한다고 생각하면 된다.
    - 스프링 데이터 JPA, Querydsl은 JPA를 더 편리하게 사용할 수 있게 도와주는 프로젝트이다. 실무에서는 JPA를 사용하면 이 프로젝트도 꼭! 함께 사용하는 것이 좋다.

### DTO(data transfer object)

- 데이터 전송 객체
- DTO는 기능은 없고 데이터를 전달만 하는 용도로 사용되는 객체를 뜻한다.
    - 참고로 DTO에 기능이 있으면 안되는가? 그것은 아니다. 객체의 주 목적이 데이터를 전송하는 것이라면 DTO라 할 수 있다.
- 객체 이름에 DTO를 꼭 붙여야 하는 것은 아니다. 대신 붙여두면 용도를 알 수 있다는 장점은 있다.
- 이전에 설명한 ItemSearchCond 도 DTO 역할을 하지만, 이 프로젝트에서 Cond 는 검색 조건으로 사용한다는 규칙을 정했다. 따라서 DTO를 붙이지 않아도 된다. ItemSearchCondDto 이렇게 하면 너무 복잡해진다. 그리고 Cond 라는 것만 봐도 용도를 알 수 있다.
- 참고로 이런 규칙은 정해진 것이 없기 때문에 해당 프로젝트 안에서 일관성 있게 규칙을 정하면 된다.

**@EventListener(ApplicationReadyEvent.class)**

- 스프링 컨테이너가 완전히 초기화를 다 끝내고,
실행 준비가 되었을 때 발생하는 이벤트이다. 스프링이 이 시점에 해당 애노테이션이 붙은 `initData()` 메서드를 호출해준다.
    - 참고로 이 기능 대신 @PostConstruct 를 사용할 경우 AOP 같은 부분이 아직 다 처리되지 않은 시점에 호출될 수 있기 때문에, 간혹 문제가 발생할 수 있다. 예를 들어서 @Transactional 과 관련된 AOP가 적용되지 않은 상태로 호출될 수 있다.
    - @EventListener(ApplicationReadyEvent.class) 는 AOP를 포함한 스프링 컨테이너가 완전히 초기화 된 이후에 호출되기 때문에 이런 문제가 발생하지 않는다.

**@Import(MemoryConfig.class)**

- 앞서 설정한 MemoryConfig 를 설정 파일로 사용한다

**프로필**

- **@Profile("local")**
- 특정 프로필의 경우에만 해당 스프링 빈을 등록한다. 여기서는 `local` 이라는 이름의 프로필이 사용되는 경우에만 `testDataInit` 이라는 스프링 빈을 등록한다. 이 빈은 앞서 본 것인데, 편의상 초기 데이터를 만들어서 저장하는 빈이다.
- 스프링은 로딩 시점에 application.properties 의 spring.profiles.active 속성을 읽어서 프로필로 사용한다.
- 이 프로필은 로컬(나의 PC), 운영 환경, 테스트 실행 등등 다양한 환경에 따라서 다른 설정을 할 때 사용하는   정보이다.

### 인터페이스를 테스트하자

> 인터페이스를 대상으로 테스트하면 향후 다른 구현체로 변경되었을 때 해당 구현체가 잘 동작하는지 같은 테스트로 편리하게 검증할 수 있다
> 

### 권장하는 식별자 선택 전략

**데이터베이스 기본 키는 다음 3가지 조건을 모두 만족해야 한다.**

1. `null` 값은 허용하지 않는다.
2. 유일해야 한다.
3. 변해선 안 된다
- 자연 키(natural key)
    - 비즈니스에 의미가 있는 키
    - 예: 주민등록번호, 이메일, 전화번호
- 대리 키(surrogate key)
    - 비즈니스와 관련 없는 임의로 만들어진 키, 대체 키로도 불린다.
    - 예: 오라클 시퀀스, auto_increment, identity, 키생성 테이블 사용
